# Density Analysis Tool

**density_analysis_tool.py** is a Python-based command-line tool designed for scientists and researchers in the field of molecular dynamics (MD) simulations. It facilitates the analysis of density data, helping to identify stationary points and key density fluctuations over time. This tool automatically generates detailed plots to visualize these dynamics, ensuring intuitive interpretation and easy integration into research workflows.

## Features

- **Data Reading**: Reads density data directly from GROMACS EDR files.
- **Rolling Statistics**: Computes rolling mean and standard deviation to analyze trends.
- **Stationary Point Detection**: Identifies stationary points where the density stabilizes.
- **Density Fluctuation Analysis**: Highlights points within a specified tolerance of the average density.
- **Interactive Selection**: Allows users to select specific data points for deeper analysis.
- **Automated Plotting**: Generates plots with detailed annotations and color gradients to distinguish key metrics.
- **Command Generation**: Constructs and displays GROMACS commands for further data manipulation.

## Installation

To use **density_analysis_tool.py**, you need Python 3 and several dependencies:

1. **pandas**: For data manipulation
2. **matplotlib**: For plotting
3. **panedr**: To read EDR files from GROMACS
4. **numpy**: For numerical operations

Install these dependencies using pip:

```bash
pip install pandas matplotlib panedr numpy
```

## Usage

Run the script from the command line by specifying the path to your EDR file and optional arguments to control the analysis:

```bash
python density_analysis_tool.py <path_to_edr_file> [options]
```

### Options

- `--window_size`: Sets the window size for rolling calculations (default: 10).
- `--mean_threshold`: Sets the threshold for identifying stationary points based on changes in the rolling mean (default: 0.1).
- `--tolerance`: Sets the tolerance for identifying points close to the average density (default: 0.01).
- `--show_points`: Sets the number of points to display (default: 20, set to -1 to display all).

### Example

```bash
python density_analysis_tool.py data/simulation.edr --window_size 15 --mean_threshold 0.05 --tolerance 0.02 --show_points 30
```

## Output

The script outputs:

- A list of points within 1% of the average density, formatted for easy reading.
- A PNG plot saved in the same directory as the input file, visualizing the density analysis.
- The exact command used for GROMACS `trjconv`, if a point is selected for extraction.

## Interactive Mode

During execution, the script prompts the user to choose a point from the list of key density points. Once a point is selected, the corresponding frame extraction command for GROMACS is displayed.

## Plot Details

The plot generated by **density_analysis_tool.py** includes:
- Blue markers for density.
- An orange line for the rolling mean.
- A red line for the rolling standard deviation.
- Special markers for points within the specified tolerance of the average density.
- Annotations and a legend describing each component of the plot.

## Contributing

Contributions to **density_analysis_tool.py** are welcome! Please fork the repository, make your changes, and submit a pull request.

## License

This tool is open-sourced under the GNU GPL3 License.
